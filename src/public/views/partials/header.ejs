<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title><%= title %></title>
  <!-- Load core theme tokens first to avoid flash, then component styles -->
  <link rel="stylesheet" href="/css/theme.css" />
  <link rel="stylesheet" href="/css/style.css" />
  <script>
    // Early theme set (runs before paint). Keeps in sync with storage key used below.
    (function(){
      try {
        var key='app-theme-preference';
        var stored = localStorage.getItem(key);
        var root = document.documentElement;
        if(stored){
          root.setAttribute('data-theme', stored);
        } else {
          // Respect system preference on first load
          var prefersLight = matchMedia('(prefers-color-scheme: light)').matches;
          root.setAttribute('data-theme', prefersLight ? 'light' : 'dark');
        }
      } catch(e) { /* no-op */ }
    })();
  </script>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>
  <div class="body-container">
    <header class="app-topbar" role="banner" style="justify-content:space-between;">
      <a href="/" class="app-logo" aria-label="Go to home">NudeForge</a>
      <div style="display:flex;align-items:center;gap:1rem;">
        <div class="processing-stats" style="display:flex;flex-direction:column;align-items:flex-start;line-height:1.1;">
          <span id="queueStatusDisplay" style="font-size:.75rem;">Queue: <span id="queueSize">0</span></span>
          <span id="processingStatusDisplay" style="font-size:.75rem;">Status: <span id="processingStatus">Idle</span><span class="progressPercentage"></span></span>
        </div>
        <div class="header-options" style="display:none;">
          <label class="header-option-label" style="font-size:.65rem;color:var(--color-text-dim);">
            <input type="checkbox" id="allowConcurrentUpload" class="header-option-checkbox" />
            Multi-upload
          </label>
        </div>
        <div class="theme-toggle">
          <button type="button" id="themeToggleBtn" class="theme-toggle-btn" aria-label="Toggle theme" title="Toggle dark / light theme">ðŸŒ™</button>
        </div>
      </div>
    </header>
    <div style="height:var(--topbar-height);"></div>
